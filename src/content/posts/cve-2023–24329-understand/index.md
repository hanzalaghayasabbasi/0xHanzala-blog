---
title: Understanding CVE-2023-24329 - Python urlparse Function
published: 2023-08-14
description: 'A detailed breakdown of CVE-2023-24329, demonstrating how Python’s urllib.parse can be exploited to bypass blocklists and the potential impact.'
image: './cover.jpg'
tags: [Python, CVE, urlparse]
category: 'Vulnerability Analysis'
draft: false
---


### What does `urlparse` do?

The `urlparse` function in Python is used to split a URL string into its components (scheme, netloc, path, params, query, fragment) or to combine these components into a complete URL string.



### Description

CVE-2023-24329 is a vulnerability in the `urllib.parse` module of Python (prior to version 3.11.4) that allows attackers to bypass domain blocklists by prepending whitespace characters to URLs.

---

### Code Analysis

![CVE-2023–24329](https://miro.medium.com/v2/resize\:fit:1400/format\:webp/1*Y1NxWiwUyNnOM3O0Sm1kwg.png)

In the sample code, certain domains (like `example.com`) are blocklisted. The function `safeURLOpener()` is then called with two versions of the same URL:

* `safeURLOpener("https://example.com")` — no space
* `safeURLOpener(" https://example.com")` — space at the beginning

Both URLs point to the same domain, but the second bypasses the filter due to the leading space.



### Target Site View

![example.com](https://miro.medium.com/v2/resize\:fit:1400/format\:webp/1*vvi5QtR7WqVDhoT_R7k48w.png)



### Execution

![request](https://miro.medium.com/v2/resize\:fit:1400/format\:webp/1*szH1srbvVlR6LvrOBn5P0w.png)

In Python versions prior to 3.11.4, even if the domain is blocklisted, the leading space tricks `urlparse` into treating it as a separate hostname. As a result, the request is allowed and a response from `https://example.com` is received.


### Impact

This vulnerability allows attackers to bypass domain or protocol filters implemented via blocklists. Exploiting this can lead to:

* Arbitrary file reads
* Remote command execution
* Server-Side Request Forgery (SSRF)
* Other critical security issues



